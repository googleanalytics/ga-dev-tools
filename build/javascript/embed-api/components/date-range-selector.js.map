{"version":3,"sources":["webpack:///webpack/bootstrap 23f100806441b68af6f7?fda7","webpack:///./src/javascript/embed-api/components/date-range-selector.js"],"names":["gapi","analytics","ready","nDaysAgo","dateFormat","convertDate","str","test","match","exec","daysAgo","Error","numDays","date","Date","setDate","getDate","month","String","getMonth","length","day","getFullYear","createComponent","execute","options","get","container","document","getElementById","template","innerHTML","dateInputs","querySelectorAll","startDateInput","value","endDateInput","setValues","setMinMax","onchange","onChange","bind","emit","max","min"],"mappings":"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","file":"date-range-selector.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 23f100806441b68af6f7","// Copyright 2014 Google Inc. All rights reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/* global gapi */\n\n\n/**\n * A DateRangeSelector component for the Embed API.\n */\ngapi.analytics.ready(function() {\n  let nDaysAgo = /(\\d+)daysAgo/;\n  let dateFormat = /\\d{4}\\-\\d{2}\\-\\d{2}/;\n\n  /**\n   * Convert a date acceptable to the Core Reporting API (e.g. `today`,\n   * `yesterday` or `NdaysAgo`) into the format YYYY-MM-DD. Dates\n   * already in that format are simply returned.\n   * @param {string} str The date string to format.\n   * @return {string} The formatted date.\n   */\n  function convertDate(str) {\n    // If str is in the proper format, do nothing.\n    if (dateFormat.test(str)) return str;\n\n    let match = nDaysAgo.exec(str);\n    if (match) {\n      return daysAgo(+match[1]);\n    } else if (str == 'today') {\n      return daysAgo(0);\n    } else if (str == 'yesterday') {\n      return daysAgo(1);\n    } else {\n      throw new Error('Cannot convert date ' + str);\n    }\n  }\n\n  /**\n   * Accept a number and return a date formatted as YYYY-MM-DD that\n   * represents that many days ago.\n   * @param {number} numDays The number of days ago whose date to return.\n   * @return {string} The formatted date.\n   */\n  function daysAgo(numDays) {\n    let date = new Date();\n    date.setDate(date.getDate() - numDays);\n    let month = String(date.getMonth() + 1);\n    month = month.length == 1 ? '0' + month: month;\n    let day = String(date.getDate());\n    day = day.length == 1 ? '0' + day: day;\n    return date.getFullYear() + '-' + month + '-' + day;\n  }\n\n  gapi.analytics.createComponent('DateRangeSelector', {\n\n    /**\n     * Initialize the DateRangeSelector instance and render it to the page.\n     * @return {DateRangeSelector} The instance.\n     */\n    execute: function() {\n      let options = this.get();\n      options['start-date'] = options['start-date'] || '7daysAgo';\n      options['end-date'] = options['end-date'] || 'yesterday';\n\n      // Allow container to be a string ID or an HTMLElement.\n      this.container = typeof options.container == 'string' ?\n        document.getElementById(options.container) : options.container;\n\n      // Allow the template to be overridden.\n      if (options.template) this.template = options.template;\n\n      this.container.innerHTML = this.template;\n      let dateInputs = this.container.querySelectorAll('input');\n\n      this.startDateInput = dateInputs[0];\n      this.startDateInput.value = convertDate(options['start-date']);\n      this.endDateInput = dateInputs[1];\n      this.endDateInput.value = convertDate(options['end-date']);\n\n      this.setValues();\n      this.setMinMax();\n\n      this.container.onchange = this.onChange.bind(this);\n      return this;\n    },\n\n    /**\n     * Emit a change event based on the currently selected dates.\n     * Pass an object containing the start date and end date.\n     */\n    onChange: function() {\n      this.setValues();\n      this.setMinMax();\n      this.emit('change', {\n        'start-date': this['start-date'],\n        'end-date': this['end-date'],\n      });\n    },\n\n    /**\n     * Updates the instance properties based on the input values.\n     */\n    setValues: function() {\n      this['start-date'] = this.startDateInput.value;\n      this['end-date'] = this.endDateInput.value;\n    },\n\n    /**\n     * Updates the input min and max attributes so there's no overlap.\n     */\n    setMinMax: function() {\n      this.startDateInput.max = this.endDateInput.value;\n      this.endDateInput.min = this.startDateInput.value;\n    },\n\n    /**\n     * The html structure used to build the component. Developers can\n     * override this by passing it to the component constructor.\n     * The only requirement is that the structure contain two inputs, the\n     * first will be the start date and the second will be the end date.\n     */\n    template:\n      '<div class=\"DateRangeSelector\">' +\n      '  <div class=\"DateRangeSelector-item\">' +\n      '    <label>Start Date</label> ' +\n      '    <input type=\"date\">' +\n      '  </div>' +\n      '  <div class=\"DateRangeSelector-item\">' +\n      '    <label>End Date</label> ' +\n      '    <input type=\"date\">' +\n      '  </div>' +\n      '</div>',\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/javascript/embed-api/components/date-range-selector.js"],"sourceRoot":""}