{"version":3,"sources":["webpack:///webpack/bootstrap 77f4c9eedf8f3c0ccdce?e231*","webpack:///./src/javascript/embed-api/components/active-users.js"],"names":["gapi","analytics","ready","createComponent","initialize","activeUsers","auth","once","handleSignOut_","bind","execute","polling_","stop","render_","isAuthorized","pollActiveUsers_","clearTimeout","timeout_","emit","opts","get","container","document","getElementById","innerHTML","template","querySelector","options","pollingInterval","isNaN","Error","client","data","realtime","ids","metrics","then","response","result","newValue","totalResults","rows","oldValue","onChange_","setTimeout","delta","valueContainer","handleSignIn_"],"mappings":"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","file":"active-users.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 77f4c9eedf8f3c0ccdce","// Copyright 2015 Google Inc. All rights reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/* global gapi */\n\n\ngapi.analytics.ready(function() {\n  gapi.analytics.createComponent('ActiveUsers', {\n\n    initialize: function() {\n      this.activeUsers = 0;\n      gapi.analytics.auth.once('signOut', this.handleSignOut_.bind(this));\n    },\n\n    execute: function() {\n      // Stop any polling currently going on.\n      if (this.polling_) {\n        this.stop();\n      }\n\n      this.render_();\n\n      // Wait until the user is authorized.\n      if (gapi.analytics.auth.isAuthorized()) {\n        this.pollActiveUsers_();\n      } else {\n        gapi.analytics.auth.once('signIn', this.pollActiveUsers_.bind(this));\n      }\n    },\n\n    stop: function() {\n      clearTimeout(this.timeout_);\n      this.polling_ = false;\n      this.emit('stop', {activeUsers: this.activeUsers});\n    },\n\n    render_: function() {\n      let opts = this.get();\n\n      // Render the component inside the container.\n      this.container = typeof opts.container == 'string' ?\n          document.getElementById(opts.container) : opts.container;\n\n      this.container.innerHTML = opts.template || this.template;\n      this.container.querySelector('b').innerHTML = this.activeUsers;\n    },\n\n    pollActiveUsers_: function() {\n      let options = this.get();\n      let pollingInterval = (options.pollingInterval || 5) * 1000;\n\n      if (isNaN(pollingInterval) || pollingInterval < 5000) {\n        throw new Error('Frequency must be 5 seconds or more.');\n      }\n\n      this.polling_ = true;\n      gapi.client.analytics.data.realtime\n          .get({ids: options.ids, metrics: 'rt:activeUsers'})\n          .then(function(response) {\n        let result = response.result;\n        let newValue = result.totalResults ? +result.rows[0][0] : 0;\n        let oldValue = this.activeUsers;\n\n        this.emit('success', {activeUsers: this.activeUsers});\n\n        if (newValue != oldValue) {\n          this.activeUsers = newValue;\n          this.onChange_(newValue - oldValue);\n        }\n\n        if (this.polling_ == true) {\n          this.timeout_ = setTimeout(this.pollActiveUsers_.bind(this),\n              pollingInterval);\n        }\n      }.bind(this));\n    },\n\n    onChange_: function(delta) {\n      let valueContainer = this.container.querySelector('b');\n      if (valueContainer) valueContainer.innerHTML = this.activeUsers;\n\n      this.emit('change', {activeUsers: this.activeUsers, delta: delta});\n      if (delta > 0) {\n        this.emit('increase', {activeUsers: this.activeUsers, delta: delta});\n      } else {\n        this.emit('decrease', {activeUsers: this.activeUsers, delta: delta});\n      }\n    },\n\n    handleSignOut_: function() {\n      this.stop();\n      gapi.analytics.auth.once('signIn', this.handleSignIn_.bind(this));\n    },\n\n    handleSignIn_: function() {\n      this.pollActiveUsers_();\n      gapi.analytics.auth.once('signOut', this.handleSignOut_.bind(this));\n    },\n\n    template:\n      '<div class=\"ActiveUsers\">' +\n        'Active Users: <b class=\"ActiveUsers-value\"></b>' +\n      '</div>',\n\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/javascript/embed-api/components/active-users.js"],"sourceRoot":""}